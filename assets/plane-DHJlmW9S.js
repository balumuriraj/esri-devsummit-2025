import{ja as z,fe as B,aE as N,hT as G,aB as M,aV as u,aA as C,cA as y,cq as d,ct as b,cx as l,bt as J,cu as Q,aR as v,cw as _}from"./index-BdTzoSyX.js";import{e as K}from"./mat3f64-q3fE-ZOt.js";import{e as W}from"./mat4f64-Dk4dwAN8.js";import{e as Y}from"./quatf64-aQ5IuZRd.js";let S=class E{constructor(e){this._create=e,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&z(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const e=2*this._itemsPtr;this._items.length>e&&(this._items.length=e),this._itemsPtr=0}static createVec2f64(){return new E(B)}static createVec3f64(){return new E(N)}static createVec4f64(){return new E(G)}static createMat3f64(){return new E(K)}static createMat4f64(){return new E(W)}static createQuatf64(){return new E(Y)}get test(){}};const Nt=S.createVec2f64(),f=S.createVec3f64(),Z=S.createVec4f64();S.createMat3f64();const Et=S.createMat4f64(),ht=S.createQuatf64();function Tt(t,e,r){const n=u(t,e)/u(t,t);return b(r,t,n)}function x(t,e){return u(t,e)/d(t)}function Mt(t,e){const r=u(t,e)/(d(t)*d(e));return-y(r)}function _t(t,e,r){M(A,t),M(L,e);const n=u(A,L),c=y(n),s=C(A,A,L);return u(s,r)<0?2*Math.PI-c:c}const A=N(),L=N();function St(t){const e=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],r=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],n=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))}function mt(t,e){const r=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),n=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),c=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return l(t,r,n,c),t}function tt(t,e,r){Math.abs(t[0])>Math.abs(t[1])?l(e,0,1,0):l(e,1,0,0),C(r,t,e),C(e,r,t),M(r,r),M(e,e)}function j(t=g){return[t[0],t[1],t[2],t[3]]}function $t(t=g[0],e=g[1],r=g[2],n=g[3]){return H(t,e,r,n,Z.get())}function et(t,e){return H(e[0],e[1],e[2],e[3],t)}function gt(t){return t}function H(t,e,r,n,c=j()){return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c}function rt(t,e,r){const n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],c=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return r[0]=e[0]*c,r[1]=e[1]*c,r[2]=e[2]*c,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function nt(t,e,r,n=j()){const c=r[0]-e[0],s=r[1]-e[1],i=r[2]-e[2],a=t[0]-e[0],D=t[1]-e[1],O=t[2]-e[2],m=s*O-i*D,w=i*a-c*O,V=c*D-s*a,p=m*m+w*w+V*V,X=Math.abs(p-1)>1e-5&&p>1e-12?1/Math.sqrt(p):1;return n[0]=m*X,n[1]=w*X,n[2]=V*X,n[3]=-(n[0]*t[0]+n[1]*t[1]+n[2]*t[2]),n}function k(t,e,r,n=0,c=Math.floor(r*(1/3)),s=Math.floor(r*(2/3))){if(r<3)return!1;e($,n);let i=c,a=!1;for(;i<r-1&&!a;)e(T,i),i++,a=!v($,T);if(!a)return!1;for(i=Math.max(i,s),a=!1;i<r&&!a;)e(h,i),i++,_(P,$,T),M(P,P),_(U,T,h),M(U,U),a=!v($,h)&&!v(T,h)&&Math.abs(u(P,U))<ct;return a?(nt($,T,h,t),!0):(n!==0||c!==1||s!==2)&&k(t,e,r,0,1,2)}function lt(t,e,r=!0){const n=e.length/3;return k(t,(c,s)=>l(c,e[3*s+0],e[3*s+1],e[3*s+2]),r?n-1:n)}const ct=.99619469809,$=N(),T=N(),h=N(),P=N(),U=N();function Dt(t,e,r){return e!==t&&et(t,e),t[3]=-u(t,r),t}function Ot(t,e){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function At(t,e,r,n){return C(h,e,t),rt(r,h,n)}function Pt(t,e,r,n){return R(q(t,e,_(f.get(),r,e),it,n))}function Ut(t,e,r){return e!=null&&R(q(t,e.origin,e.direction,st,r))}function Ct(t,e,r){return R(q(t,e.origin,e.vector,I.NONE,r))}function bt(t,e,r){return R(q(t,e.origin,e.vector,I.CLAMP,r))}function Ft(t,e){return F(t,e)>=0}function Rt(t,e){const r=u(t,e.ray.direction),n=-F(t,e.ray.origin);if(r>-1e-6&&r<1e-6)return n>0;const c=n/r;return r>0?c<e.c1&&(e.c1=c):c>e.c0&&(e.c0=c),e.c0<=e.c1}function qt(t,e,r){const n=b(f.get(),t,-t[3]),c=at(t,_(f.get(),e,n),f.get());return Q(r,c,n),r}function wt(t,e,r,n){const c=t,s=f.get(),i=f.get();tt(c,s,i);const a=_(f.get(),r,e),D=x(s,a),O=x(i,a),m=x(c,a);return l(n,D,O,m)}function at(t,e,r){const n=b(f.get(),t,u(t,e));return _(r,e,n),r}function Vt(t,e){return Math.abs(F(t,e))}function F(t,e){return u(t,e)+t[3]}var o;function R(t){return t===o.INTERSECTS_INSIDE_OUT||t===o.INTERSECTS_OUTSIDE_IN}function q(t,e,r,n,c){const s=u(t,r),i=F(t,e);if(s===0)return i>=0?o.INSIDE:o.OUTSIDE;let a=-i/s;return n&I.CLAMP&&(a=J(a,0,1)),!(n&I.INFINITE_MIN)&&a<0||!(n&I.INFINITE_MAX)&&a>1?i>=0?o.INSIDE:o.OUTSIDE:(Q(c,e,b(c,r,a)),i>=0?o.INTERSECTS_INSIDE_OUT:o.INTERSECTS_OUTSIDE_IN)}(function(t){t[t.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",t[t.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE"})(o||(o={}));const g=[0,0,1,0];var I;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})(I||(I={}));const it=I.INFINITE_MIN|I.INFINITE_MAX,st=I.INFINITE_MAX;export{lt as A,$t as D,Rt as G,qt as H,wt as J,Ot as L,j as M,gt as O,At as P,Vt as Q,H as U,F as V,Et as a,Mt as b,f as c,tt as d,x as f,mt as g,et as h,Tt as i,Pt as k,rt as l,St as m,ht as o,nt as p,Ct as q,Z as r,Nt as t,_t as u,k as v,bt as w,Ut as x,Dt as y,Ft as z};
