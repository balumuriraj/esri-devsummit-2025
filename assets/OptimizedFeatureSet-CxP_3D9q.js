import{e as M}from"./memoryEstimations-yxcmaqK-.js";import{e as q}from"./OptimizedGeometry-DUXeneY0.js";function G(t,e){return t?e?4:3:e?3:2}function O(t,e,s,i){if(!(e!=null&&e.lengths.length))return null;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const r=t.coords,o=[],n=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:u,coords:h}=e,f=G(s,i);let m=0;for(const l of u){const c=P(n,h,m,l,s,i);c&&o.push(c),m+=l*f}if(o.sort((l,c)=>{let N=l[2]-c[2];return N===0&&s&&(N=l[4]-c[4]),N}),o.length){let l=6*o[0][2];r[0]=o[0][0]/l,r[1]=o[0][1]/l,s&&(l=6*o[0][4],r[2]=l!==0?o[0][3]/l:0),(r[0]<n[0]||r[0]>n[1]||r[1]<n[2]||r[1]>n[3]||s&&(r[2]<n[4]||r[2]>n[5]))&&(r.length=0)}if(!r.length){const l=e.lengths[0]?S(h,0,u[0],s,i):null;if(!l)return null;r[0]=l[0],r[1]=l[1],s&&l.length>2&&(r[2]=l[2])}return t}function P(t,e,s,i,r,o){const n=G(r,o);let u=s,h=s+n,f=0,m=0,l=0,c=0,N=0;for(let b=0,p=i-1;b<p;b++,u+=n,h+=n){const a=e[u],I=e[u+1],g=e[u+2],d=e[h],y=e[h+1],V=e[h+2];let F=a*y-d*I;c+=F,f+=(a+d)*F,m+=(I+y)*F,r&&(F=a*V-d*g,l+=(g+V)*F,N+=F),a<t[0]&&(t[0]=a),a>t[1]&&(t[1]=a),I<t[2]&&(t[2]=I),I>t[3]&&(t[3]=I),r&&(g<t[4]&&(t[4]=g),g>t[5]&&(t[5]=g))}if(c>0&&(c*=-1),N>0&&(N*=-1),!c)return null;const T=[f,m,.5*c];return r&&(T[3]=l,T[4]=.5*N),T}function S(t,e,s,i,r){const o=G(i,r);let n=e,u=e+o,h=0,f=0,m=0,l=0;for(let c=0,N=s-1;c<N;c++,n+=o,u+=o){const T=t[n],b=t[n+1],p=t[n+2],a=t[u],I=t[u+1],g=t[u+2],d=i?w(T,b,p,a,I,g):j(T,b,a,I);if(d)if(h+=d,i){const y=A(T,b,p,a,I,g);f+=d*y[0],m+=d*y[1],l+=d*y[2]}else{const y=_(T,b,a,I);f+=d*y[0],m+=d*y[1]}}return h>0?i?[f/h,m/h,l/h]:[f/h,m/h]:s>0?i?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function j(t,e,s,i){const r=s-t,o=i-e;return Math.sqrt(r*r+o*o)}function w(t,e,s,i,r,o){const n=i-t,u=r-e,h=o-s;return Math.sqrt(n*n+u*u+h*h)}function _(t,e,s,i){return[t+.5*(s-t),e+.5*(i-e)]}function A(t,e,s,i,r,o){return[t+.5*(i-t),e+.5*(r-e),s+.5*(o-s)]}class E{constructor(e=null,s={},i,r,o=0){this.geometry=e,this.attributes=s,this.centroid=i,this.objectId=r,this.displayId=o}static fromJSON(e){const s=e.geometry?q.fromJSON(e.geometry):null,i=e.centroid?q.fromJSON(e.centroid):null,r=e.objectId;return new E(s,e.attributes,i,r)}weakClone(){const e=new E(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){var i,r;const e=(i=this.geometry)==null?void 0:i.clone(),s=new E(e,{...this.attributes},(r=this.centroid)==null?void 0:r.clone(),this.objectId);return s.displayId=this.displayId,s}ensureCentroid(e){return this.centroid??(this.centroid=O(new q,this.geometry,e.hasZ,e.hasM)),this.centroid}get usedMemory(){var e;return 128+M(this.attributes)+(((e=this.geometry)==null?void 0:e.usedMemory)??0)}}function $(t){var e,s;return!!((s=(e=t.geometry)==null?void 0:e.coords)!=null&&s.length)}class Y{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new Y;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}export{Y as e,O as n,$ as o,E as s};
