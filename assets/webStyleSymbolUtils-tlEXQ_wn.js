import{c as x,a as S}from"./devEnvironmentUtils-CnNDiFMM.js";import{a as D,dJ as u,ae as f,cy as w,fH as O,fI as P,fJ as v,fK as F,fL as A,fM as N,fN as U,fO as C,fP as H,fQ as K}from"./CodeBlock-DBIw63CI.js";import{e as L}from"./webStyleAcceptedFormats-CG7ZQ6BV.js";import"./index-BYYG-xAB.js";function B(t,e,a){const l=t.name;return l==null?Promise.reject(new f("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?W(l,e,a):C(t,e,a).then(n=>R(n,l,e,H,a))}function Q(t,e){return e.items.find(a=>a.name===t)}async function R(t,e,a,l,n){var h,d;const o=(a==null?void 0:a.portal)!=null?a.portal:D.getDefault(),r={portal:o,url:u(t.baseUrl)},m=Q(e,t.data);if(!m)throw new f("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});const c=(n==null?void 0:n.acceptedFormats)??L,p=l(m,c);if(!p)throw new f("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${c})`,{symbolName:e});const{url:I,format:T}=p;let i=w(I,r),y=((h=m.thumbnail)==null?void 0:h.href)??null;const b=(d=m.thumbnail)==null?void 0:d.imageData;x()&&(i=S(i)??"",y=S(y));const E={portal:o,url:u(O(i)),origin:"portal-item"};return P(i,n).then(g=>{const J=T==="cim"?v(g.data):g.data,s=F(J,E);if(s&&A(s)){if(y){const M=w(y,r);s.thumbnail=new N({url:M})}else b&&(s.thumbnail=new N({url:`data:image/png;base64,${b}`}));t.styleUrl?s.styleOrigin=new U({portal:a.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(s.styleOrigin=new U({portal:a.portal,styleName:t.styleName,name:e}))}return s})}function W(t,e,a){const l=K.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:D.getDefault();return P(l,a).then(o=>{const r=v(o.data);return F(r,{portal:n,url:u(O(l)),origin:"portal-item"})})}export{R as fetchSymbolFromStyle,Q as getStyleItemFromStyle,B as resolveWebStyleSymbol};
